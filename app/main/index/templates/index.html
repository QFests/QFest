{% extends "base.html" %}
{% block mycontent %}

<style>
.dropbtn {
  background-color: white;
  color: black;
  padding: 16px;
  font-size: 16px;
  border: none;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {background-color: #ddd;}

.dropdown:hover .dropdown-content {display: block;}

</style>
    <div class="row animated fadeInDown">
        <div class="col-sm-8 col-sm-offset-2">
            <form class="form form-horizontal" method="get" action="{{ url_for('alcohol.index') }}">
                <div class="input-group  input-group-lg">
                    {{ search_form.search(placeholder="Press <return> Search for",class_="form-control") }}
                <span class="input-group-btn">
                    <input class="btn btn-primary" id="submit" name="submit" type="submit" value="Search">
                </span>
                </div>
            </form>
        </div>
    </div>


    <table class="table table-striped table-hover animated fadeInDown">
        <img id="product-img" style='vertical-align:middle;' src="https://iconape.com/wp-content/files/hr/374248/png/374248.png" width="35" height="35">

        <div class="dropdown" style='vertical-align:middle; display:inline;'>
          <button class="dropbtn"> Popular alcohols </button>
          <div class="dropdown-content">
            <a href="http://0.0.0.0:5000/?search=Beer">Beer</a>
            <a href="http://0.0.0.0:5000/?search=Vine">Vine</a>
            <a href="http://0.0.0.0:5000/?search=Rom">Rom</a>
          </div>
        <tbody>

        <tr>
            {% for alcohol in alcohols %}
                {% if loop.index <= 4 %}
                <td class="hidden-xs">
                        <div id = "product-image-container">
                            {%- if alcohol.image -%}
                            <img id="product-img" src="{{ alcohol.image }}" alt="{{ alcohol.title~' Cover' }}">
                            {%- else -%}
                            <img id="product-img" src="https://image.shutterstock.com/image-photo/text-coming-soon-appearing-behind-260nw-1934155757.jpg">
                            {%- endif -%}
                        </div>
                        <a href="{{ url_for('alcohol.detail',alcohol_id=alcohol.id) }}">{{ alcohol.title }}</a>
                    {% if current_user.is_authenticated %}
                    {% with log =current_user.purchase(alcohol) %}
                        {% if log %}
                            <a class="btn btn-primary"
                                   href="{{ url_for('log.alcohol_return',log_id=log.id,next=request.path) }}">Del from fav</a>
                        {% else %}
                            <a class="btn btn-success"
                                   href="{{ url_for('log.alcohol_buy',alcohol_id=alcohol.id,next=request.path) }}"
                                   {% if not alcohol.can_buy() %}disabled="disabled"{% endif %}>
                                Add to fav
                            </a>
                        {% endif %}
                    {% endwith %}
                {% endif %}
                </td>
            {% endif %}
                    {% endfor %}
            </tr>
<tr>
            {% for alcohol in alcohols %}
                {% if 4 < loop.index <= 8 %}
                <td class="hidden-xs">
                        <div id = "product-image-container">
                            {%- if alcohol.image -%}
                            <img id="product-img" src="{{ alcohol.image }}" alt="{{ alcohol.title~' Cover' }}">
                            {%- else -%}
                            <img id="product-img" src="https://image.shutterstock.com/image-photo/text-coming-soon-appearing-behind-260nw-1934155757.jpg">
                            {%- endif -%}
                        </div>
                        <a href="{{ url_for('alcohol.detail',alcohol_id=alcohol.id) }}">{{ alcohol.title }}</a>

                    {% if current_user.is_authenticated %}
                    {% with log =current_user.purchase(alcohol) %}
                        {% if log %}
                            <a class="btn btn-primary"
                                   href="{{ url_for('log.alcohol_return',log_id=log.id,next=request.path) }}">Del from fav</a>
                        {% else %}
                            <a class="btn btn-success"
                                   href="{{ url_for('log.alcohol_buy',alcohol_id=alcohol.id,next=request.path) }}"
                                   {% if not alcohol.can_buy() %}disabled="disabled"{% endif %}>
                                Add to fav
                            </a>
                        {% endif %}
                    {% endwith %}
                {% endif %}
                </td>
            {% endif %}
                    {% endfor %}
            </tr>
        <tr>
            {% for alcohol in alcohols %}
                {% if 8 < loop.index <= 12 %}
                <td class="hidden-xs">
                        <div id = "product-image-container">
                            {%- if alcohol.image -%}
                            <img id="product-img" src="{{ alcohol.image }}" alt="{{ alcohol.title~' Cover' }}">
                            {%- else -%}
                            <img id="product-img" src="https://image.shutterstock.com/image-photo/text-coming-soon-appearing-behind-260nw-1934155757.jpg">
                            {%- endif -%}
                        </div>
                        <a href="{{ url_for('alcohol.detail',alcohol_id=alcohol.id) }}">{{ alcohol.title }}</a>

                    {% if current_user.is_authenticated %}
                    {% with log =current_user.purchase(alcohol) %}
                        {% if log %}
                            <a class="btn btn-primary"
                                   href="{{ url_for('log.alcohol_return',log_id=log.id,next=request.path) }}">Del from fav</a>
                        {% else %}
                            <a class="btn btn-success"
                                   href="{{ url_for('log.alcohol_buy',alcohol_id=alcohol.id,next=request.path) }}"
                                   {% if not alcohol.can_buy() %}disabled="disabled"{% endif %}>
                                Add to fav
                            </a>
                        {% endif %}
                    {% endwith %}
                {% endif %}
                </td>
            {% endif %}
                    {% endfor %}
            </tr>
        </tbody>
    </table>
    <div class="row animated fadeInUp delay">
        <div class="col-md-9">
            <h4>Latest alcohol reviews</h4>
            {% for comment in recently_comments %}
                <li class="list-group-item clearfix animated fadeInLeft delay-{{ loop.index0 }}">
                    <div class="media">
                        {% if comment.user.avatar_url() %}
                            <div class="media-left">
                                <a href="{{ url_for('user.detail',user_id=comment.user.id) }}">
                                    <div class="media-object avatar avatar-mini"
                                         style="background-image: url({{ comment.user.avatar_url() }})"></div>
                                </a>
                            </div>
                        {% endif %}
                        <div class="media-body">
                            <p class="media-heading"><a
                                    href="{{ url_for('user.detail',user_id=comment.user.id) }}">
                                {{ comment.user.name }}</a>
                                <small>{{ comment.user.headline or "" }}</small>
                                {% if comment.create_timestamp==comment.edit_timestamp %}
                                    <span class="pull-right">
                                        <small>
                                            Posted on: {{ comment.create_timestamp.strftime('%d %B %Y - %H:%M:%S') }}</small>
                                    </span>
                                {% else %}
                                    <span class="pull-right">
                                        <small>
                                            Edited on: {{ comment.edit_timestamp.strftime('%d %B %Y - %H:%M:%S') }}</small>
                                    </span>
                                {% endif %}
                            </p>
                            <span class="line-wrap">{{ "Evaluated 「"~comment.alcohol.title~"」 : " }}</span>
                            <span class="line-wrap"><a class="list-group-item-text"
                                                       href="{{ url_for('alcohol.detail',alcohol_id=comment.alcohol_id) }}">{{ comment.comment }}</a></span>
                        </div>
                    </div>
                </li>
            {% endfor %}
        </div>
        <div class="col-md-3 animated fadeInUp">
            <table class="table table-striped table-hover">
                <caption>Cloud Reader Top 5</caption>
                <thead>
                <tr>
                    <th>User's name</th>
                    <th>Number of Purchase</th>
                </tr>
                </thead>
                <tbody>
                {% for user in users %}
                    <tr class="animated fadeInLeft delay-{{ loop.index0 }}">
                        <td><a href="{{ url_for('user.detail',user_id=user.id) }}">{{ user.name }}</a></td>
                        <td>{{ user.logs.count() }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
{% endblock %}